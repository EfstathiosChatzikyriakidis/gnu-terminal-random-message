<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GNU terminal random message server: src/signal_handlers.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<h1>src/signal_handlers.c File Reference</h1>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;syslog.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/wait.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &quot;<a class="el" href="program__typedefs_8h-source.html">program_typedefs.h</a>&quot;</code><br>

<p>
<a href="signal__handlers_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#6e54a991b692d287a141792a848ff42a">cleanup_files</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#419b44a3411eb187ffb02ab22f77312c">signals_handler</a> (<a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#4d813a8974826212a410b96cdca94b98">term_handler</a> (<a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#7c25b78a141ae25acbfcaa8ef3fb7eeb">clean_up_process</a> (<a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#e6313881a6478d29474287c5fb444814">signals_support</a> (<a class="el" href="program__typedefs_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile sig_atomic_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="signal__handlers_8c.html#585f7999e87ba9504e16c50d07ce489e">keep_going</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7c25b78a141ae25acbfcaa8ef3fb7eeb"></a><!-- doxytag: member="signal_handlers.c::clean_up_process" ref="7c25b78a141ae25acbfcaa8ef3fb7eeb" args="(cint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clean_up_process           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signal__handlers_8c-source.html#l00052">52</a> of file <a class="el" href="signal__handlers_8c-source.html">signal_handlers.c</a>.
<p>
Referenced by <a class="el" href="server__operations_8c-source.html#l00133">server_run()</a>, and <a class="el" href="signal__handlers_8c-source.html#l00081">signals_handler()</a>.<div class="fragment"><pre class="fragment"><a name="l00053"></a>00053 {
<a name="l00054"></a>00054   <span class="comment">/* are used for cleaning up zombies. */</span>
<a name="l00055"></a>00055   <span class="keywordtype">int</span> status;
<a name="l00056"></a>00056   pid_t pid;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="comment">/* clean up all zombie processes. */</span>
<a name="l00059"></a>00059   <span class="keywordflow">while</span> ((pid = waitpid (-1, &amp;status, WNOHANG)) &gt; 0);
<a name="l00060"></a>00060 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6e54a991b692d287a141792a848ff42a"></a><!-- doxytag: member="signal_handlers.c::cleanup_files" ref="6e54a991b692d287a141792a848ff42a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_files           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="419b44a3411eb187ffb02ab22f77312c"></a><!-- doxytag: member="signal_handlers.c::signals_handler" ref="419b44a3411eb187ffb02ab22f77312c" args="(cint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void signals_handler           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signal__handlers_8c-source.html#l00081">81</a> of file <a class="el" href="signal__handlers_8c-source.html">signal_handlers.c</a>.
<p>
References <a class="el" href="signal__handlers_8c-source.html#l00052">clean_up_process()</a>, and <a class="el" href="signal__handlers_8c-source.html#l00065">term_handler()</a>.
<p>
Referenced by <a class="el" href="signal__handlers_8c-source.html#l00105">signals_support()</a>.<div class="fragment"><pre class="fragment"><a name="l00082"></a>00082 {
<a name="l00083"></a>00083   <span class="keywordflow">switch</span> (sig)
<a name="l00084"></a>00084     {
<a name="l00085"></a>00085       <span class="comment">/* finalize the server */</span>
<a name="l00086"></a>00086     <span class="keywordflow">case</span> SIGTERM:
<a name="l00087"></a>00087       <a class="code" href="signal__handlers_8c.html#4d813a8974826212a410b96cdca94b98">term_handler</a> (sig);
<a name="l00088"></a>00088       <span class="keywordflow">break</span>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       <span class="comment">/* cleanup a zombie process. */</span>
<a name="l00091"></a>00091     <span class="keywordflow">case</span> SIGCHLD:
<a name="l00092"></a>00092       <a class="code" href="signal__handlers_8c.html#7c25b78a141ae25acbfcaa8ef3fb7eeb">clean_up_process</a> (sig);
<a name="l00093"></a>00093       <span class="keywordflow">break</span>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095       <span class="comment">/* just inform. */</span>
<a name="l00096"></a>00096     <span class="keywordflow">default</span>:
<a name="l00097"></a>00097       syslog (LOG_INFO, <span class="stringliteral">"signal found: `%d'."</span>, sig);
<a name="l00098"></a>00098       <span class="keywordflow">break</span>;
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e6313881a6478d29474287c5fb444814"></a><!-- doxytag: member="signal_handlers.c::signals_support" ref="e6313881a6478d29474287c5fb444814" args="(bool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void signals_support           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="program__typedefs_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="4d813a8974826212a410b96cdca94b98"></a><!-- doxytag: member="signal_handlers.c::term_handler" ref="4d813a8974826212a410b96cdca94b98" args="(cint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void term_handler           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="program__typedefs_8h.html#1f6289ab1328cf3c7852d75c397838a2">cint</a>&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="signal__handlers_8c-source.html#l00065">65</a> of file <a class="el" href="signal__handlers_8c-source.html">signal_handlers.c</a>.
<p>
References <a class="el" href="cleanup_8c-source.html#l00041">cleanup_files()</a>, and <a class="el" href="server__operations_8c-source.html#l00049">keep_going</a>.
<p>
Referenced by <a class="el" href="signal__handlers_8c-source.html#l00081">signals_handler()</a>.<div class="fragment"><pre class="fragment"><a name="l00066"></a>00066 {
<a name="l00067"></a>00067   <span class="comment">/* log informative message. */</span>
<a name="l00068"></a>00068   syslog (LOG_INFO, <span class="stringliteral">"termination signal found."</span>);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="comment">/* try to remove files. */</span>
<a name="l00071"></a>00071   <a class="code" href="cleanup_8c.html#6e54a991b692d287a141792a848ff42a">cleanup_files</a> ();
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <span class="comment">/* stop the server. */</span>
<a name="l00074"></a>00074   <a class="code" href="server__operations_8c.html#585f7999e87ba9504e16c50d07ce489e">keep_going</a> = <span class="keyword">false</span>;
<a name="l00075"></a>00075 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="585f7999e87ba9504e16c50d07ce489e"></a><!-- doxytag: member="signal_handlers.c::keep_going" ref="585f7999e87ba9504e16c50d07ce489e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile sig_atomic_t <a class="el" href="signal__handlers_8c.html#585f7999e87ba9504e16c50d07ce489e">keep_going</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="server__operations_8c-source.html#l00049">49</a> of file <a class="el" href="server__operations_8c-source.html">server_operations.c</a>.
<p>
Referenced by <a class="el" href="server__operations_8c-source.html#l00133">server_run()</a>, and <a class="el" href="signal__handlers_8c-source.html#l00065">term_handler()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jun 30 23:19:06 2008 for GNU terminal random message server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
